<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="portal_button" inherit_id="portal.placeholder_user_sign_in" name="Paylox Button">
        <xpath expr="." position="inside">
            <li t-if="pay_page" id="menu_pay" groups="base.group_portal,base.group_user" t-attf-class="#{_item_class} o_no_autohide_item">
                <a href="/pay" t-attf-class="#{_link_class}">
                    <i class="fa fa-credit-card mr-2" t-translation="off"/>Payment
                </a>
            </li>
        </xpath>
    </template>

    <template id="user_dropdown" inherit_id="portal.user_dropdown" name="Paylox Button Dropdown">
        <xpath expr="//li[@t-if='is_connected']" position="attributes">
            <attribute name="t-attf-class">nav-item dropdown o_no_autohide_item</attribute>
        </xpath>
    </template>

    <template id="page_payment" name="Paylox Payment Page">
        <t t-call="web.frontend_layout">
            <t t-set="title" t-value="website.name"/>
            <t t-set="x_icon" t-value="'/web/image?model=website&amp;id=%s&amp;field=favicon' % website.id"/>
            <t t-set="body_classname" t-value="'payment-page'"/>
            <t t-call="payment_jetcheckout.payment_card"/>
        </t>
    </template>

    <template id="s2s" name="Paylox S2S Form">
        <t t-if="order">
            <t t-set="model" t-value="order.sudo()"/>
            <t t-set="success_url" t-value="'/payment/card/shop'"/>
            <t t-set="fail_url" t-value="'/payment/card/shop'"/>
            <t t-set="amount" t-value="model.amount_total"/>
            <t t-set="partner" t-value="model.partner_invoice_id or model.partner_id"/>
            <t t-set="currency" t-value="model.currency_id"/>
            <input type="hidden" t-att-value="model.id" field="payment.order"/>
        </t>
        <t t-elif="sale_order and sale_order._name == 'sale.order'">
            <t t-set="model" t-value="sale_order.sudo()"/>
            <t t-set="success_url" t-value="'/payment/card/order/%s/%s' % (model.id, model.access_token)"/>
            <t t-set="fail_url" t-value="'/payment/card/order/%s/%s' % (model.id, model.access_token)"/>
            <t t-set="amount" t-value="model.amount_total"/>
            <t t-set="partner" t-value="model.partner_invoice_id or model.partner_id"/>
            <t t-set="currency" t-value="model.currency_id"/>
            <input type="hidden" t-att-value="model.id" field="payment.order"/>
        </t>
        <t t-elif="invoice and invoice._name == 'account.move'">
            <t t-set="model" t-value="invoice.sudo()"/>
            <t t-set="success_url" t-value="'/payment/card/invoice/%s/%s' % (model.id, model.access_token)"/>
            <t t-set="fail_url" t-value="'/payment/card/invoice/%s/%s' % (model.id, model.access_token)"/>
            <t t-set="amount" t-value="model.amount_total"/>
            <t t-set="partner" t-value="model.partner_id"/>
            <t t-set="currency" t-value="model.currency_id"/>
            <input type="hidden" t-att-value="model.id" field="payment.invoice"/>
        </t>
        <t t-elif="account and account._name == 'sale.subscription'">
            <t t-set="model" t-value="account.sudo()"/>
            <t t-set="success_url" t-value="'/payment/card/subscription/%s/%s' % (model.id, model.uuid)"/>
            <t t-set="fail_url" t-value="'/payment/card/subscription/%s/%s' % (model.id, model.uuid)"/>
            <t t-set="amount" t-value="model.recurring_total"/>
            <t t-set="partner" t-value="model.partner_invoice_id or model.partner_id"/>
            <t t-set="currency" t-value="model.currency_id"/>
            <input type="hidden" t-att-value="model.id" field="payment.subscription"/>
        </t>
        <t t-else="">
            <t t-if="access_token">
                <t t-if="sale_order_id">
                    <t t-set="model" t-value="request.env['sale.order'].sudo().browse(sale_order_id)"/>
                    <t t-set="success_url" t-value="'/payment/card/custom/%s/%s' % (model.id, access_token)"/>
                    <t t-set="fail_url" t-value="'/payment/card/custom/%s/%s' % (model.id, access_token)"/>
                    <t t-set="partner" t-value="model.partner_invoice_id or model.partner_id"/>
                    <t t-set="currency" t-value="model.currency_id"/>
                    <input type="hidden" t-att-value="model.id" field="payment.order"/>
                </t>
                <t t-elif="invoice_id">
                    <t t-set="model" t-value="request.env['account.move'].sudo().browse(invoice_id)"/>
                    <t t-set="success_url" t-value="'/payment/card/custom/%s/%s' % (model.id, access_token)"/>
                    <t t-set="fail_url" t-value="'/payment/card/custom/%s/%s' % (model.id, access_token)"/>
                    <t t-set="partner" t-value="model.partner_id"/>
                    <t t-set="currency" t-value="model.currency_id"/>
                    <input type="hidden" t-att-value="model.id" field="payment.invoice"/>
                </t>
            </t>
        </t>

        <t t-if="model">
            <t t-set="no_button" t-value="True"/>
            <t t-set="no_card_family" t-value="True"/>
            <t t-set="no_loading" t-value="True"/>
        </t>

        <t t-if="not ok">
            <t t-set="partner" t-value="partner.commercial_partner_id"/>
            <t t-set="contact" t-value="partner.parent_id and partner"/>
            <t t-set="company" t-value="company or acquirer.company_id or request.env.company"/>
            <t t-set="currency" t-value="currency or company.currency_id"/>
            <t t-set="user" t-value="not request.env.user.share"/>
            <t t-set="no_terms" t-value="not acquirer.provider == 'jetcheckout' or acquirer.jetcheckout_no_terms"/>
        </t>

        <t t-set="language" t-value="request.env['res.lang']._lang_get(request.env.lang)"/>
        <input type="hidden" t-att-value="language.format('%.{0}f'.format(currency.decimal_places), currency.round(amount), grouping=True, monetary=True)" field="amount"/>
        <input type="hidden" t-att-data-decimal="currency.decimal_places" t-att-data-separator="language.decimal_point" t-att-data-thousand="language.thousands_sep" t-att-data-name="currency.name" t-att-data-id="currency.id" t-att-data-position="currency.position" t-att-data-symbol="currency.symbol" field="currency"/>
        <input type="hidden" name="success_url" t-att-value="success_url" field="payment.successurl"/>
        <input type="hidden" name="fail_url" t-att-value="fail_url" field="payment.failurl"/>
        <input type="hidden" name="partner" t-att-value="partner.id" field="partner"/>
        <div id="payment_card">
            <t t-call="payment_jetcheckout.payment_form">
                <t t-set="s2s" t-value="True"/>
                <t t-set="no_button" t-value="no_button"/>
                <t t-set="no_card_family" t-value="no_card_family"/>
                <t t-set="no_loading" t-value="no_loading"/>
                <t t-set="no_terms" t-value="no_terms"/>
            </t>
        </div>
    </template>

    <template id="payment_sidebar" name="Paylox Payment Sidebar">
        <div t-attf-class="col-#{size or 'md'}-3 payment-amount w-100 d-flex flex-column">
            <div>
                <div t-if="page in ['payment', 'result']" class="px-3 py-4 bg-white card my-4 shadow overflow-revert">
                    <t t-set="language" t-value="request.env['res.lang']._lang_get(request.env.lang)"/>
                    <input type="hidden" t-att-data-decimal="currency.decimal_places" t-att-data-separator="language.decimal_point" t-att-data-thousand="language.thousands_sep" t-att-data-name="currency.name" t-att-data-id="currency.id" t-att-data-position="currency.position" t-att-data-symbol="currency.symbol" field="currency"/>
                    <t t-if="page == 'payment'">
                        <div class="amount">
                            <div class="field-container w-100">
                                <input id="amount" name="amount" type="text" inputmode="decimal" class="text-center border-primary" required="required" field="amount" t-att-placeholder="language.format('%.{0}f'.format(currency.decimal_places), 0, grouping=True, monetary=True)" t-att-value="amount and language.format('%.{0}f'.format(currency.decimal_places), amount, grouping=True, monetary=True) or None"/>
                                <span class="bar-container"/>
                                <span t-if="currency.position == 'before'" class="symbol symbol-before" t-esc="currency.symbol"/>
                                <span t-else="" class="symbol symbol-after" t-esc="currency.symbol"/>
                                <label for="amount" class="text-primary"><span>Amount to Pay</span></label>
                            </div>
                            <button t-if="len(currencies) > 1 and not readonly" class="btn btn-primary shadow text-nowrap" field="button.currency">
                                <span t-esc="currency.name"/>
                                <i class="fa fa-caret-down ml4" t-translation="off"/>
                                <ul>
                                    <t t-foreach="currencies" t-as="curr">
                                        <li t-esc="curr.name" t-att-data-separator="language.decimal_point" t-att-data-thousand="language.thousands_sep" t-att-data-decimal="curr.decimal_places" t-att-data-name="curr.name" t-att-data-id="curr.id" t-att-data-position="curr.position" t-att-data-symbol="curr.symbol"/>
                                    </t>
                                </ul>
                            </button>
                        </div>
                    </t>
                    <t t-elif="page == 'result'">
                        <button t-if="tx and tx.state == 'done'" class="btn btn-primary btn-block mt-3 font-weight-bold text-uppercase disabled shadow" disabled="disabled"><i class="fa fa-check mr-2" t-translation="off"/>Success</button>
                        <button t-elif="tx and tx.state == 'authorized'" class="btn btn-primary btn-block mt-3 font-weight-bold text-uppercase disabled shadow" disabled="disabled"><i class="fa fa-check mr-2" t-translation="off"/>Authorized</button>
                        <button t-else="" class="btn btn-primary btn-block mt-3 font-weight-bold text-uppercase disabled shadow" disabled="disabled"><i class="fa fa-times mr-2" t-translation="off"/>Fail</button>
                    </t>
                    <div t-if="page == 'payment' and not no_payment_icons" class="mt-3">
                        <ul class="mb-0 text-center list-inline payment_icon_list">
                            <t t-set="i" t-value="0"/>
                            <t t-foreach="acquirer.payment_icon_ids" t-as="pm_icon">
                                <li t-attf-class="list-inline-item#{'' if (i &lt; 5) else ' d-none'}">
                                    <span t-field="pm_icon.image_payment_form"
                                        t-options='{"widget": "image", "alt-field": "name"}'/>
                                </li>
                                <li t-if="i==5" class="list-inline-item d-block">
                                    <span class="float-right more_option text-info">
                                        <a href="#" class="o_payment_form_pay_icon_more" data-toggle="tooltip" t-att-title="', '.join([opt.name for opt in acquirer.payment_icon_ids[5:]])">and more</a>
                                    </span>
                                </li>
                                <t t-set="i" t-value="i+1"/>
                            </t>
                        </ul>
                    </div>
                </div>
                <div t-if="page in ['payment', 'transaction', 'ledger'] and not no_partner_info" class="px-3 py-4 bg-white card my-4">
                    <label name="partner" class="text-primary font-weight-bold mb-0 d-block">
                        <t t-if="partner_label" t-raw="partner_label"/>
                        <t t-else="">Partner</t>
                    </label>
                    <span name="partner" class="text-600"><t t-esc="partner_name or '-'"/></span>
                    <t t-if="contact">
                        <label name="contact" class="text-primary font-weight-bold mt-2 mb-0 d-block">
                            <t t-if="contact_label" t-raw="contact_label"/>
                            <t t-else="">Contact</t>
                        </label>
                        <span name="contact" class="text-600"><t t-esc="contact.name or '-'"/></span>
                    </t>
                    <t t-if="labels" t-raw="labels"/>
                    <input type="hidden" name="partner" t-att-value="partner.id" field="partner"/>
                    <t t-if="buttons" t-raw="buttons"/>
                </div>
                <div t-if="page == 'payment' and not no_card_preview" style="height: 200px;">
                    <t t-call="payment_jetcheckout.payment_preview"/>
                </div>
                <t t-raw="0"/>
            </div>
        </div>
    </template>

    <template id="payment_smart_button" name="Paylox Payment Smart Buttons">
        <div t-if="not no_smart_buttons and not s2s" class="oe_button_box row mx-0">
            <a t-if="page != 'payment'" role="button" href="/pay" class="btn oe_stat_button col-md-3">
                <i class="fa fa-fw o_button_icon fa-undo icon"></i>
                <div class="o_stat_info">
                    <span class="o_stat_text">Return</span><span class="o_stat_text">Payment</span>
                </div>
            </a>
            <a t-if="page in ('payment', 'transaction')" role="button" href="/payment/card/ledger" class="btn oe_stat_button col-md-3">
                <i class="fa fa-fw o_button_icon fa-book icon"></i>
                <div class="o_stat_info">
                    <span class="o_stat_text">Balance</span>
                    <span class="o_stat_text"><span t-esc="partner_balance_sign_str" t-att-title="partner_balance_sign_title" class="badge badge-pill border"/> <span t-esc="partner_balance"/></span>
                </div>
            </a>
            <a t-if="page in ('payment', 'ledger')" role="button" href="/payment/card/transactions" class="btn oe_stat_button col-md-3">
                <i class="fa fa-fw o_button_icon fa-list icon"></i>
                <div class="o_stat_info">
                    <span class="o_stat_text">Last</span><span class="o_stat_text">Transactions</span>
                </div>
            </a>
        </div>
    </template>

    <template id="payment_card" name="Paylox Payment Card">
        <div id="payment_card" class="row justify-content-center mx-0 h-100">
            <t t-call="payment_jetcheckout.payment_sidebar">
                <t t-set="page" t-value="'payment'"/>
            </t>
            <div class="col-md-9 row justify-content-center mx-0 navbar-light">
                <t t-call="payment_jetcheckout.payment_form"/>
            </div>
        </div>
    </template>

    <template id="payment_preview" name="Paylox Card Preview">
        <div class="creditcard" field="card.sample">
            <div class="front">
                <div id="cardpreview" field="card.preview"></div>
                <svg id="cardfront" x="0px" y="0px" viewBox="0 0 750 471" style="enable-background:new 0 0 750 471;" xml:space="preserve">
                    <g id="Front">
                        <g id="CardBackground">
                            <g id="Page-1_1_">
                                <g id="amex_1_">
                                    <path id="Rectangle-1_1_" class="lightcolor grey" d="M40,0h670c22.1,0,40,17.9,40,40v391c0,22.1-17.9,40-40,40H40c-22.1,0-40-17.9-40-40V40 C0,17.9,17.9,0,40,0z"/>
                                </g>
                            </g>
                            <path class="darkcolor greydark" d="M750,431V193.2c-217.6-57.5-556.4-13.5-750,24.9V431c0,22.1,17.9,40,40,40h670C732.1,471,750,453.1,750,431z"/>
                        </g>
                        <text transform="matrix(1 0 0 1 60.106 295.0121)" id="svgnumber" class="st2 st3 st4">0123 4567 8910 1112</text>
                        <text transform="matrix(1 0 0 1 54.1064 428.1723)" id="svgname" class="st2 st5 st6"></text>
                        <text transform="matrix(1 0 0 1 54.1074 389.8793)" class="st7 st5 st8">Cardholder Name</text>
                        <text transform="matrix(1 0 0 1 479.7754 388.8793)" class="st7 st5 st8">Expiration</text>
                        <text transform="matrix(1 0 0 1 65.1054 241.5)" class="st7 st5 st8">Card Number</text>
                        <g>
                            <text transform="matrix(1 0 0 1 574.4219 433.8095)" id="svgexpire" class="st2 st5 st9">**/**</text>
                            <text transform="matrix(1 0 0 1 479.3848 417.0097)" class="st2 st10 st11">VALID</text>
                            <text transform="matrix(1 0 0 1 479.3848 435.6762)" class="st2 st10 st11">THRU</text>
                            <polygon class="st2" points="554.5,421 540.4,414.2 540.4,427.9"/>
                        </g>
                        <g id="cchip">
                            <g>
                                <path class="st2" d="M168.1,143.6H82.9c-10.2,0-18.5-8.3-18.5-18.5V74.9c0-10.2,8.3-18.5,18.5-18.5h85.3 c10.2,0,18.5,8.3,18.5,18.5v50.2C186.6,135.3,178.3,143.6,168.1,143.6z"/>
                            </g>
                            <g>
                                <g>
                                    <rect x="82" y="70" class="st12" width="1.5" height="60"/>
                                </g>
                                <g>
                                    <rect x="167.4" y="70" class="st12" width="1.5" height="60"/>
                                </g>
                                <g>
                                    <path class="st12" d="M125.5,130.8c-10.2,0-18.5-8.3-18.5-18.5c0-4.6,1.7-8.9,4.7-12.3c-3-3.4-4.7-7.7-4.7-12.3 c0-10.2,8.3-18.5,18.5-18.5s18.5,8.3,18.5,18.5c0,4.6-1.7,8.9-4.7,12.3c3,3.4,4.7,7.7,4.7,12.3 C143.9,122.5,135.7,130.8,125.5,130.8z M125.5,70.8c-9.3,0-16.9,7.6-16.9,16.9c0,4.4,1.7,8.6,4.8,11.8l0.5,0.5l-0.5,0.5 c-3.1,3.2-4.8,7.4-4.8,11.8c0,9.3,7.6,16.9,16.9,16.9s16.9-7.6,16.9-16.9c0-4.4-1.7-8.6-4.8-11.8l-0.5-0.5l0.5-0.5 c3.1-3.2,4.8-7.4,4.8-11.8C142.4,78.4,134.8,70.8,125.5,70.8z"/>
                                </g>
                                <g>
                                    <rect x="82.8" y="82.1" class="st12" width="25.8" height="1.5"/>
                                </g>
                                <g>
                                    <rect x="82.8" y="117.9" class="st12" width="26.1" height="1.5"/>
                                </g>
                                <g>
                                    <rect x="142.4" y="82.1" class="st12" width="25.8" height="1.5"/>
                                </g>
                                <g>
                                    <rect x="142" y="117.9" class="st12" width="26.2" height="1.5"/>
                                </g>
                            </g>
                        </g>
                    </g>
                    <g id="Back">
                    </g>
                </svg>
            </div>
            <div class="back">
                <svg id="cardback" x="0px" y="0px" viewBox="0 0 750 471" style="enable-background:new 0 0 750 471;" xml:space="preserve">
                    <g id="Front">
                        <line class="st0" x1="35.3" y1="10.4" x2="36.7" y2="11"/>
                    </g>
                    <g id="Back">
                        <g id="Page-1_2_">
                            <g id="amex_2_">
                                <path id="Rectangle-1_2_" class="darkcolor greydark" d="M40,0h670c22.1,0,40,17.9,40,40v391c0,22.1-17.9,40-40,40H40c-22.1,0-40-17.9-40-40V40 C0,17.9,17.9,0,40,0z"/>
                            </g>
                        </g>
                        <rect y="61.6" class="st2" width="750" height="78"/>
                        <g>
                            <path class="st3" d="M701.1,249.1H48.9c-3.3,0-6-2.7-6-6v-52.5c0-3.3,2.7-6,6-6h652.1c3.3,0,6,2.7,6,6v52.5 C707.1,246.4,704.4,249.1,701.1,249.1z"/>
                            <rect x="42.9" y="198.6" class="st4" width="664.1" height="10.5"/>
                            <rect x="42.9" y="224.5" class="st4" width="664.1" height="10.5"/>
                            <path class="st5" d="M701.1,184.6H618h-8h-10v64.5h10h8h83.1c3.3,0,6-2.7,6-6v-52.5C707.1,187.3,704.4,184.6,701.1,184.6z"/>
                        </g>
                        <text transform="matrix(1 0 0 1 621.999 227.2734)" id="svgsecurity" class="st6 st7">***</text>
                        <g class="st8">
                            <text transform="matrix(1 0 0 1 518.083 280.0879)" class="st9 st6 st10">Security Code</text>
                        </g>
                        <rect x="58.1" y="378.6" class="st11" width="375.5" height="13.5"/>
                        <rect x="58.1" y="405.6" class="st11" width="421.7" height="13.5"/>
                        <text transform="matrix(1 0 0 1 59.5073 228.6099)" id="svgnameback" class="st12 st13"></text>
                    </g>
                </svg>
            </div>
        </div>
    </template>

    <template id="payment_contactless_form" name="Paylox Contactless Payment Form">
        <button class="btn btn-primary btn-block px-2 py-4 font-weight-bold" field="payment.contactless">Pay Contactless</button>
    </template>

    <template id="payment_form" name="Paylox Payment Form">
        <t t-if="not types" t-set="types" t-value="[{'code': 'virtual_pos', 'name': ''}]"/>
        <t t-call="payment_jetcheckout.payment_loading"/>
        <div t-attf-class="w-100 bg-white my-4 h-fit #{'' if no_border else 'border card'}">
            <t t-call="payment_jetcheckout.payment_smart_button">
                <t t-set="page" t-value="'payment'"/>
            </t>
            <div id="payment_type" t-attf-class="payment-type #{'' if len(types or []) &gt; 1 else 'd-none'}">
                <t t-set="type_selected" t-value="True"/>
                <t t-foreach="types" t-as="t">
                    <button class="btn btn-secondary text-primary" t-att-data-name="t['code']" field="type.all">
                        <input type="radio" class="d-none" name="payment_type" t-att-checked="'checked' if type_selected else None" t-att-value="t['code']"/>
                        <span t-esc="t['name']"/>
                    </button>
                    <t t-set="type_selected" t-value="False"/>
                </t>
            </div>
            <t t-foreach="types" t-as="ptype">
                <div t-if="ptype['code'] == 'virtual_pos'" t-attf-id="payment_type_#{ptype['code']}" t-attf-class="row justify-content-center px-3 #{'d-none' if types and types[0]['code'] != 'virtual_pos' else ''}">
                    <div class="payment-table mt-2 p-3 col-md-6">
                        <div t-if="not s2s" class="payment-info">
                            <i class="fa fa-credit-card mr-3" t-translation="off"></i>Card Information
                        </div>
                        <div t-if="not s2s" class="payment-info-sub">
                            Please specify a payment amount from sidebar and enter your credit card details here
                        </div>
                        <div class="payment-form-container payment-gradient border card">
                            <div class="field-container">
                                <input id="cardholder" type="text" required="required" field="card.holder"/>
                                <span class="bar-container"/>
                                <label for="cardholder"><span>Name</span></label>
                            </div>
                            <div class="field-container">
                                <input id="cardnumber" inputmode="numeric" pattern="[0-9\s]*" type="text" required="required" field="card.number"/>
                                <span class="bar-container"/>
                                <div t-attf-class="#{'d-none' if no_card_family else 'cclogo overflow-hidden fade card flex-row'}" field="card.logo"/>
                                <svg t-attf-class="#{'d-none' if no_card_family else 'ccicon fade'}" width="750" height="471" viewBox="0 0 750 471" field="card.icon"/>
                                <label for="cardnumber"><span>Card Number</span></label>
                            </div>
                            <div class="field-container">
                                <input id="carddate" inputmode="numeric" pattern="[0-9\/]*" placeholder="MM/YY" type="text" required="required" field="card.date"/>
                                <span class="bar-container"/>
                                <label for="carddate"><span>Expiration</span></label>
                            </div>
                            <div class="field-container">
                                <input id="cardcode" inputmode="numeric" pattern="[0-9]*" type="text" required="required" field="card.code"/>
                                <span class="bar-container"/>
                                <label for="cardcode"><span t-if="s2s">CVC</span><span t-else="">Security Code</span></label>
                            </div>
                            <div t-if="not no_terms" class="field-container">
                                <div class="terms-container justify-content-end">
                                    <label for="term" class="btn mb-0 cursor-pointer" field="terms.all">Terms &amp; Conditions</label>
                                    <label class="switch mb-0">
                                        <input id="term" type="checkbox" field="terms.ok"/>
                                        <span class="slider round fa"/>
                                    </label>
                                </div>
                            </div>
                            <div class="field-container">
                                <button class="btn btn-paylox-token-list border-0 text-primary font-weight-bold" field="card.token.list">Saved Cards</button>
                                <button class="btn btn-paylox-point border-0 text-primary font-weight-bold" field="card.point">Query Points</button>
                            </div>
                        </div>
                    </div>
                    <div class="payment-table mt-2 p-3 col-md-6">
                        <div t-if="not s2s" class="payment-info">
                            <i class="fa fa-align-right mr-3" t-translation="off"></i>Installment Information
                        </div>
                        <div t-if="not s2s" class="payment-info-sub">
                            Installment details is placed here when you fill your card details
                        </div>
                        <div t-attf-class="payment-gradient border card p-3 #{'installment-cols' if installment_type == 'c' else 'installment-rows'}">
                            <div>
                                <div class="font-weight-bold text-primary text-uppercase installment-line mb-2 installment-header" field="installment.colempty">
                                    <t t-call="payment_jetcheckout.payment_installment_header"/>
                                </div>
                                <div class="d-none font-weight-bold text-primary text-uppercase installment-line installment-header" field="installment.col"/>
                            </div>
                            <div class="d-none installment-row overflow-auto flex-fill" t-att-data-type="installment_type or 'i'" field="installment.row"/>
                            <div class="text-muted small h-100 w-75 text-center mt72 mx-auto flex-fill" field="installment.rowempty">
                                <i class="fa fa-info-circle mb-3" t-translation="off"></i><br/>Appliable installment options will be displayed here after you enter your credit card number
                            </div>
                            <div t-if="user and (not installment_type or installment_type == 'i')" class="row font-weight-bold justify-content-center small">Campaign: <span id="campaign" class="ml-2" t-esc="campaign or '-'" field="campaign.text"/></div>
                            <div t-if="not no_button" class="row font-weight-bold text-uppercase">
                                <div class="col-xl-6 p-2">
                                    <div field="installment.table">
                                        <button class="installment-container lg btn btn-primary shadow w-100 text-nowrap overflow-hidden h-100 align-items-center justify-content-center text-overflow-ellipsis"><i class="fa fa-th mr-2" t-translation="off"></i>Installment Options</button>
                                        <button class="installment-container sm btn btn-primary shadow w-100 text-nowrap overflow-hidden h-100 align-items-center justify-content-center text-overflow-ellipsis"><i class="fa fa-th mr-2" t-translation="off"></i>Installments</button>
                                    </div>
                                    <div t-if="user and (not installment_type or installment_type == 'i')" class="mt-2" field="campaign.table">
                                        <button class="campaign-container lg btn btn-primary shadow w-100 text-nowrap overflow-hidden h-100 align-items-center justify-content-center text-overflow-ellipsis"><i class="fa fa-gift mr-2" t-translation="off"></i>Campaign Options</button>
                                        <button class="campaign-container sm btn btn-primary shadow w-100 text-nowrap overflow-hidden h-100 align-items-center justify-content-center text-overflow-ellipsis"><i class="fa fa-gift mr-2" t-translation="off"></i>Campaigns</button>
                                    </div>
                                </div>
                                <div class="col-xl-6 p-2" name="payment_button">
                                    <div>
                                        <button class="align-items-center btn btn-primary d-flex h-100 justify-content-center overflow-hidden shadow text-nowrap w-100 text-overflow-ellipsis" field="payment.button">Pay<i class="fa fa-arrow-circle-right ml-2" t-translation="off"/></button>
                                    </div>
                                </div>
                            </div>
                            <div t-else="" class="row font-weight-bold text-uppercase">
                                <div class="col-12 p-2" field="installment.table">
                                    <button class="installment-container btn btn-primary shadow w-100 text-nowrap overflow-hidden text-overflow-ellipsis"><i class="fa fa-th mr-2" t-translation="off"/>Installment Options</button>
                                </div>
                                <div class="d-none">
                                    <button class="d-none" field="payment.button"/>
                                </div>
                            </div>
                            <input type="hidden" t-att-value="campaign or ''" field="campaign.name"/>
                        </div>
                    </div>
                    <input type="hidden" t-att-value="s2s" field="payment.s2s"/>
                </div>
                <div t-elif="ptype['code'] == 'physical_pos'" t-attf-id="payment_type_#{ptype['code']}" t-attf-class="justify-content-center px-3 #{'d-none' if types and types[0]['code'] != 'physical_pos' else ''}">
                </div>
                <div t-elif="ptype['code'] == 'soft_pos'" t-attf-id="payment_type_#{ptype['code']}" t-attf-class="justify-content-center px-3 #{'d-none' if types and types[0]['code'] != 'soft_pos' else ''}">
                </div>
                <div t-elif="ptype['code'] == 'transfer'" t-attf-id="payment_type_#{ptype['code']}" t-attf-class="payment-type-transfer px-3 #{'d-none' if types and types[0]['code'] != 'transfer' else ''}">
                    <t t-set="transfer_id" t-value="1"/>
                    <div t-foreach="transfers" t-as="transfer" t-att-data-id="transfer['id']" t-att-data-name="transfer['name']" field="type.transfer">
                        <div class="payment-type-transfer-bank">
                            <div>
                                <input type="radio" name="payment_type_transfer" t-att-value="transfer['name']" t-att-checked="transfer_id == transfer['id'] and 'checked' or None"/>
                                <span/>
                                <strong t-esc="transfer['name']"/>
                            </div>
                            <div>
                                <img t-att-src="transfer['image']"/>
                            </div>
                        </div>
                        <div class="payment-type-transfer-desc d-flex flex-column justify-content-between h-100">
                            <button class="align-items-center btn btn-primary d-flex justify-content-center overflow-hidden text-nowrap w-100 text-overflow-ellipsis payment-type-transfer-payment" field="payment.button">Pay<i class="fa fa-arrow-circle-right ml-2" t-translation="off"/></button>
                        </div>
                    </div>
                </div>
                <div t-elif="ptype['code'] == 'wallet'" t-attf-id="payment_type_#{ptype['code']}" t-attf-class="payment-type-wallet px-3 #{'d-none' if types and types[0]['code'] != 'wallet' else ''}">
                    <t t-set="wallet_id" t-value="wallets[0]['wallets'][0]['id'] if wallets and wallets[0]['wallets'] else 0"/>
                    <t t-foreach="wallets" t-as="w">
                        <div t-foreach="w['wallets']" t-as="wallet" t-att-value="wallet['name']" t-att-data-id="wallet['id']" field="type.wallet">
                            <div class="payment-type-wallet-bank">
                                <div>
                                    <input type="radio" name="payment_type_wallet" t-att-value="w['name']" t-att-data-id="wallet['id']" t-att-checked="wallet_id == wallet['id'] and 'checked' or None"/>
                                    <span/>
                                    <strong t-esc="wallet['name']"/>
                                </div>
                                <div>
                                    <img t-att-src="wallet['image']"/>
                                </div>
                            </div>
                            <div class="payment-type-wallet-desc d-flex flex-column justify-content-between h-100">
                                <div>
                                    <t t-raw="wallet['desc']"/>
                                </div>
                                <button class="align-items-center btn btn-primary d-flex justify-content-center overflow-hidden text-nowrap w-100 text-overflow-ellipsis payment-type-wallet-payment" field="payment.button">Pay<i class="fa fa-arrow-circle-right ml-2" t-translation="off"/></button>
                            </div>
                        </div>
                    </t>
                </div>
                <div t-elif="ptype['code'] == 'credit'" t-attf-id="payment_type_#{ptype['code']}" t-attf-class="payment-type-credit px-3 #{'d-none' if types and types[0]['code'] != 'credit' else ''}">
                    <t t-set="credit_id" t-value="1"/>
                    <div t-foreach="shopping_credits" t-as="credit" t-att-data-id="credit['id']" t-att-data-code="credit['code']" field="type.credit">
                        <div class="payment-type-credit-bank">
                            <div>
                                <input type="radio" name="payment_type_credit" t-att-value="credit['code']" t-att-data-campaign="credit['campaign']" t-att-checked="credit_id == credit['id'] and 'checked' or None"/>
                                <span/>
                                <strong t-esc="credit['name']"/>
                            </div>
                            <div>
                                <img t-att-src="credit['image']"/>
                            </div>
                        </div>
                        <div class="payment-type-credit-desc d-flex flex-column justify-content-between h-100">
                            <div>
                                <t t-raw="credit['desc']"/>
                            </div>
                            <button class="align-items-center btn btn-primary d-flex justify-content-center overflow-hidden text-nowrap w-100 text-overflow-ellipsis payment-type-credit-payment" field="payment.button">Pay<i class="fa fa-arrow-circle-right ml-2" t-translation="off"/></button>
                        </div>
                    </div>
                </div>
            </t>
        </div>
    </template>

    <template id="payment_installment_header" name="Paylox Installment Table Header">
        <t t-if="installment_type == 'c'">
            <div class="text-center"><t t-if="s2s">Install.</t><t t-else="">Installment</t></div>
            <div class="text-center">Campaign</div>
        </t>
        <t t-elif="installment_type == 'ct'">
            <div class="text-center">Campaign</div>
            <div class="text-center"><t t-if="s2s">Install.</t><t t-else="">Installment</t></div>
            <div class="text-center">Monthly</div>
            <div class="text-center">Total</div>
        </t>
        <t t-else="">
            <div class="text-center"><t t-if="s2s">Install.</t><t t-else="">Installment</t></div>
            <div t-if="not s2s" class="text-center">Rate</div>
            <div class="text-center">Monthly</div>
            <div class="text-center">Total</div>
        </t>
    </template>

    <template id="payment_loading" name="Paylox Payment Loading">
        <div t-if="not no_loading" class="o_loading">
            <em class="fa fa-spin fa-circle-o-notch text-primary h1"/>
        </div>
    </template>

    <template id="page_result" name="Paylox Payment Result">
        <t t-call="web.frontend_layout">
            <t t-set="title" t-value="website.name"/>
            <t t-set="x_icon" t-value="'/web/image?model=website&amp;id=%s&amp;field=favicon' % website.id"/>
            <t t-set="body_classname" t-value="'payment-page'"/>
            <div class="payment-result row justify-content-center mx-0 h-100">
                <t t-call="payment_jetcheckout.payment_sidebar">
                    <t t-set="page" t-value="'result'"/>
                </t>
                <div class="col-md-9 row justify-content-center mx-0 navbar-light">
                    <div class="border shadow w-100 bg-white text-center mr-4 my-4 pb-4 h-fit">
                        <t t-call="payment_jetcheckout.payment_smart_button">
                            <t t-set="page" t-value="'result'"/>
                        </t>
                        <h4 t-if="tx != False and tx.state == 'done'" class="font-weight-bold m-3 p-3 text-center w-100 text-800">
                            <div class="text-center w-100">Payment is successful. Thank you.</div>
                            <div class="row w-100 mt-2">
                                <div class="p-3 col-md-6"><a t-attf-href="/payment/card/report/receipt/#{tx.jetcheckout_order_id}" class="btn btn-secondary btn-block font-weight-bold text-uppercase" target="_blank"><i class="fa fa-file-text-o mr-2" t-translation="off"/>Receipt</a></div>
                                <div class="p-3 col-md-6"><a t-attf-href="/payment/card/report/conveyance/#{tx.jetcheckout_order_id}" class="btn btn-secondary btn-block font-weight-bold text-uppercase" target="_blank"><i class="fa fa-edit mr-2" t-translation="off"/>Conveyance</a></div>
                            </div>
                        </h4>
                        <h4 t-elif="tx != False and tx.state == 'authorized'" class="font-weight-bold m-3 p-3 text-center w-100 text-800">
                            <div class="text-center w-100">Payment has been held on pre-authorization.</div>
                            <div class="row w-100 mt-2">
                                <div class="p-3 col-md-6"><a t-attf-href="/payment/card/report/receipt/#{tx.jetcheckout_order_id}" class="btn btn-secondary btn-block font-weight-bold text-uppercase" target="_blank"><i class="fa fa-file-text-o mr-2" t-translation="off"/>Receipt</a></div>
                                <div class="p-3 col-md-6"><a t-attf-href="/payment/card/report/conveyance/#{tx.jetcheckout_order_id}" class="btn btn-secondary btn-block font-weight-bold text-uppercase" target="_blank"><i class="fa fa-edit mr-2" t-translation="off"/>Conveyance</a></div>
                            </div>
                        </h4>
                        <h4 t-elif="tx != False and tx.state == 'pending'" class="font-weight-bold m-3 p-3 text-center w-100 text-800">
                            <div class="mb-3 text-center w-100">Payment is successful, but it will be processed later.</div>
                            <span class="font-italic font-weight-light btn-sm">Transaction is done, but a technical error occured and we couldn't record your payment. Please contact with us for more information.</span>
                        </h4>
                        <h4 t-else="" class="font-weight-bold m-3 p-3 text-center w-100 text-800">
                            <div class="mb-3 text-center w-100">Payment is not successful. Please try again later.</div>
                            <span class="font-italic font-weight-light btn-sm">Transaction is done, but a technical error occured and we couldn't record your payment. Please contact with us for more information.</span>
                            <span t-esc="tx.state_message" class="font-italic font-weight-light btn-sm"/>
                        </h4>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="page_ledger" name="Paylox Partner Ledger">
        <t t-call="web.frontend_layout">
            <t t-set="title" t-value="website.name"/>
            <t t-set="x_icon" t-value="'/web/image?model=website&amp;id=%s&amp;field=favicon' % website.id"/>
            <t t-set="body_classname" t-value="'payment-page'"/>
            <div class="payment-ledger row justify-content-center mx-0 h-100">
                <t t-call="payment_jetcheckout.payment_sidebar">
                    <t t-set="page" t-value="'ledger'"/>
                </t>
                <div class="col-md-9 justify-content-center mx-0 navbar-light">
                    <div class="border shadow bg-white my-4 pb-3">
                        <t t-call="payment_jetcheckout.payment_smart_button">
                            <t t-set="page" t-value="'ledger'"/>
                        </t>
                        <table class="table-responsive-md table-stripped w-100 small">
                            <thead>
                                <tr class="font-weight-bold">
                                    <th class="py-3 pl-2">Date</th>
                                    <th>Due Date</th>
                                    <th>Account</th>
                                    <th>Ref</th>
                                    <th class="text-right">Debit</th>
                                    <th class="text-right">Credit</th>
                                    <th class="text-right pr-2">Balance</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="amount_balance" t-value="balance - balance_sum"/>
                                <t t-foreach="amls" t-as="aml">
                                    <tr class="border">
                                        <td class="py-2 pl-2"><span t-field="aml.date"/></td>
                                        <td><span t-field="aml.date_maturity"/></td>
                                        <td><span t-field="aml.account_id.code"/></td>
                                        <td><span t-field="aml.name"/></td>
                                        <td class="text-right"><span t-field="aml.debit"/></td>
                                        <td class="text-right"><span t-field="aml.credit"/></td>
                                        <td class="border-right text-right pr-2"><span t-esc="amount_balance" t-options="{'widget': 'monetary', 'display_currency': aml.currency_id}"/></td>
                                    </tr>
                                    <t t-set="amount_balance" t-value="amount_balance - aml.balance"/>
                                </t>
                            </tbody>
                        </table>
                        <div class="form-inline justify-content-center mt-3">
                            <t t-call="website.pager"/>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="page_transaction" name="Paylox Payment Transactions">
        <t t-call="web.frontend_layout">
            <t t-set="title" t-value="website.name"/>
            <t t-set="x_icon" t-value="'/web/image?model=website&amp;id=%s&amp;field=favicon' % website.id"/>
            <t t-set="body_classname" t-value="'payment-page'"/>
            <div class="payment-transaction row justify-content-center mx-0 h-100">
                <t t-call="payment_jetcheckout.payment_sidebar">
                    <t t-set="page" t-value="'transaction'"/>
                </t>
                <div class="col-md-9 justify-content-center mx-0 navbar-light">
                    <div class="border shadow bg-white text-center my-4 pb-3">
                        <t t-call="payment_jetcheckout.payment_smart_button">
                            <t t-set="page" t-value="'transaction'"/>
                        </t>
                        <table class="table-responsive-md table-fold w-100 small">
                            <thead>
                                <tr class="font-weight-bold">
                                    <th class="py-3">Date</th>
                                    <th>Transaction</th>
                                    <th>Card Holder Name</th>
                                    <th>Card Number</th>
                                    <th>Payment Amount</th>
                                    <th>State</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="txs" t-as="tx">
                                    <tr t-attf-class="border row-view #{'bg-success-light' if tx.state == 'done' else 'bg-danger-light'}">
                                        <td class="py-2"><span t-field="tx.create_date"/></td>
                                        <td><span t-field="tx.reference"/></td>
                                        <td><span t-field="tx.jetcheckout_card_name"/></td>
                                        <td><span t-field="tx.jetcheckout_card_number"/></td>
                                        <td><span t-field="tx.jetcheckout_payment_amount"/></td>
                                        <td class="border-right"><span t-field="tx.state"/></td>
                                    </tr>
                                    <tr class="border bg-100 row-fold">
                                        <td colspan="99">
                                            <table class="w-100">
                                                <tr class="font-weight-bold border">
                                                    <td>Commission Amount</td>
                                                    <td>Installment Count</td>
                                                    <td rowspan="2" class="border-left p-2">
                                                        <!--<a t-attf-href="/report/pdf/payment_jetcheckout.payment_receipt/#{tx.id}" class="btn btn-secondary btn-block font-weight-bold text-uppercase" target="_blank" title="Receipt"><i class="fa fa-file-text-o mr-2" t-translation="off"/></a>
                                                        <a t-attf-href="/report/pdf/payment_jetcheckout.payment_conveyance/#{tx.id}" class="btn btn-secondary btn-block font-weight-bold text-uppercase" target="_blank" title="Conveyance"><i class="fa fa-edit mr-2" t-translation="off"/></a>-->
                                                        <a t-attf-href="/report/html/payment_jetcheckout.payment_receipt/#{tx.id}" class="btn btn-secondary btn-block font-weight-bold text-uppercase" target="_blank" title="Receipt"><i class="fa fa-file-text-o mr-2" t-translation="off"/></a>
                                                        <a t-attf-href="/report/html/payment_jetcheckout.payment_conveyance/#{tx.id}" class="btn btn-secondary btn-block font-weight-bold text-uppercase" target="_blank" title="Conveyance"><i class="fa fa-edit mr-2" t-translation="off"/></a>
                                                    </td>
                                                </tr>
                                                <tr class="border">
                                                    <td><span t-field="tx.jetcheckout_customer_amount"/></td>
                                                    <td><span t-field="tx.jetcheckout_installment_count"/></td>
                                                </tr>
                                                <tr class="border">
                                                    <td colspan="5" class="text-left pl-2"><span class="font-weight-bold">Message:</span> <span t-field="tx.state_message"/></td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                        <div class="form-inline justify-content-center mt-3">
                            <t t-call="website.pager"/>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="page_token_verify" name="Paylox Card Token Verify Page">
        <t t-call="web.frontend_layout">
            <t t-set="no_header" t-value="True"/>
            <t t-set="no_footer" t-value="True"/>
            <t t-set="title" t-value="'%s | Card Token Verify' % website.name"/>
            <t t-set="x_icon" t-value="'/web/image?model=website&amp;id=%s&amp;field=favicon' % website.id"/>
            <t t-set="body_classname" t-value="'payment-page payment-token-verify'"/>
            <div class="o_loading">
                <em class="fa fa-4x fa-spin fa-circle-o-notch d-none"/>
            </div>
            <t t-set="language" t-value="request.env['res.lang']._lang_get(request.env.lang)"/>
            <input type="hidden" t-att-data-decimal="currency.decimal_places" t-att-data-separator="language.decimal_point" t-att-data-thousand="language.thousands_sep" t-att-data-name="currency.name" t-att-data-id="currency.id" t-att-data-position="currency.position" t-att-data-symbol="currency.symbol" field="currency"/>
            <input type="hidden" name="success_url" t-att-value="success_url" field="payment.successurl"/>
            <input type="hidden" name="fail_url" t-att-value="fail_url" field="payment.failurl"/>
            <input type="hidden" name="partner" t-att-value="partner.id" field="partner"/>
            <div class="payment-card row justify-content-center mx-0 h-100">
                <div class="col-md-6 row justify-content-center mx-0">
                    <div class="payment-table mt-2 p-3">
                        <div class="payment-form-container payment-gradient">
                            <div class="field-container">
                                <input id="cardholder" type="text" required="required" field="card.holder"/>
                                <span class="bar-container"/>
                                <label for="cardholder"><span>Name</span></label>
                            </div>
                            <div class="field-container">
                                <input id="cardnumber" inputmode="numeric" pattern="[0-9\s]*" type="text" required="required" field="card.number"/>
                                <span class="bar-container"/>
                                <div t-attf-class="#{'d-none' if no_card_family else 'cclogo overflow-hidden fade card flex-row'}" field="card.logo"/>
                                <svg t-attf-class="#{'d-none' if no_card_family else 'ccicon fade'}" width="750" height="471" viewBox="0 0 750 471" field="card.icon"/>
                                <label for="cardnumber"><span>Card Number</span></label>
                            </div>
                            <div class="field-container">
                                <input id="carddate" inputmode="numeric" pattern="[0-9\/]*" placeholder="MM/YY" type="text" required="required" field="card.date"/>
                                <span class="bar-container"/>
                                <label for="carddate"><span>Expiration</span></label>
                            </div>
                            <div class="field-container">
                                <input id="cardcode" inputmode="numeric" pattern="[0-9]*" type="text" required="required" field="card.code"/>
                                <span class="bar-container"/>
                                <label for="cardcode"><span t-if="s2s">CVC</span><span t-else="">Security Code</span></label>
                            </div>
                            <button class="payment-token-verify-button btn" field="payment.button">
                                Verify
                            </button>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 row justify-content-center mx-0 navbar-light pt48">
                    <t t-call="payment_jetcheckout.payment_preview"/>
                </div>
            </div>
        </t>
    </template>

    <template id="page_token_result" name="Paylox Card Token Verify Result Page">
        <t t-call="web.frontend_layout">
            <t t-set="no_header" t-value="True"/>
            <t t-set="no_footer" t-value="True"/>
            <t t-set="title" t-value="'%s | Card Token Verify Result' % website.name"/>
            <t t-set="x_icon" t-value="'/web/image?model=website&amp;id=%s&amp;field=favicon' % website.id"/>
            <t t-set="body_classname" t-value="'payment-token-result'"/>
            <t t-if="tx">
                <div t-if="tx.state == 'error'" class="text-center justify-content-center flex-column mt-4 my-2 mx-4">
                    <div class="w-100 h2 text-danger">Your credit card verification has been failed. Please try again. If this situation occurs anyway, please contact with system administation.</div>
                    <small class="d-block mt-1" t-esc="tx.state_message"/>
                </div>
                <div t-elif="tx.state == 'done'" class="text-center justify-content-center flex-column mt-4 my-2 mx-4">
                    <div class="w-100 h2 text-700">Your credit card has been successfully verified.</div>
                    <input id="success" type="hidden"/>
                    <em class="d-block mt-1 text-600">Redirecting...</em>
                </div>
                <div t-else="" class="text-center justify-content-center flex-column mt-4 my-2 mx-4">
                    <div class="w-100h2 text-danger">Your credit card verification status: <span t-field="tx.state"/>. Please try again. If this situation occurs anyway, please contact with system administation.</div>
                    <small class="d-block mt-1" t-esc="tx.state_message"/>
                </div>
            </t>
            <t t-else="">
                <div class="text-center justify-content-center flex-column mt-4 my-2 mx-4">
                    <div class="w-100 h2 text-danger">Credit card verification status could not be retrieved. Please close the dialog and check the verification again.</div>
                    <small class="d-block mt-1" t-esc="tx.state_message"/>
                </div>
            </t>
        </t>
    </template>
</odoo>
